import os
import sqlite3

# Set the path of the user's Chrome cookies database file
cookies_path = os.path.expanduser("~") + "/AppData/Local/Google/Chrome/User Data/Default/Cookies"

# Connect to the Chrome cookies database file
conn = sqlite3.connect(cookies_path)

# Get the cookies data from the database
cursor = conn.execute('SELECT host_key, name, value, path, encrypted_value FROM cookies')

# Write the cookies data to a txt file
with open('cookies.txt', 'w') as f:
    for row in cursor:
        decrypted_value = ""
        if row[4] is not None:
            # Decrypt the encrypted cookie value
            try:
                # Import the necessary Cryptodome modules
                from Cryptodome.Cipher import AES
                from Cryptodome.Protocol.KDF import PBKDF2

                # Derive the key from the user's Chrome login password
                password = input("Please enter your Chrome login password: ")
                salt = b'saltysalt'
                iv = b' ' * 16
                length = 16
                iterations = 1003
                key = PBKDF2(password, salt, length, iterations)

                # Decrypt the cookie value
                cipher = AES.new(key, AES.MODE_CBC, IV=iv)
                decrypted_value = cipher.decrypt(row[4][3:]).decode()

                # Remove the padding from the decrypted value
                padding_length = ord(decrypted_value[-1])
                decrypted_value = decrypted_value[:-padding_length]

            except Exception as e:
                print("Failed to decrypt cookie: " + str(e))
                decrypted_value = "<unable to decrypt>"
        f.write(str(row[0]) + "\t" + str(row[1]) + "\t" + str(row[2]) + "\t" + str(row[3]) + "\t" + decrypted_value + "\n")

# Close the connection to the database
conn.close()



#This script connects to the user's Chrome cookies database file, retrieves the cookies data, and writes it to a txt file named "cookies.txt". If a cookie value is encrypted, the script prompts the user to enter their Chrome login password to decrypt it.



